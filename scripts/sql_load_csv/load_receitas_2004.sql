use tse;

-- load candidatos
# NO_CAND";"DS_CARGO";"CD_CARGO";"NR_CAND";"SG_UE_SUP";"NO_UE";"SG_UE";"NR_PART";"SG_PART";"VR_RECEITA";"DT_RECEITA";"RTRIM(LTRIM(DR.DS_TITULO))";"CD_TITULO";"DECODE(REC.TP_RECURSO,0,'EMESP�CIE',1,'CHEQUE',2,'ESTIMADO','N�OINFORMADO')";"TP_RECURSO";"NO_DOADOR";"CD_CPF_CGC_DOA";"RV_MEANING

load data local infile 'fontes_tse/2004/prestacao_contas_2004/2004/Candidato/Receita/ReceitaCandidato.CSV'
  into table doacoes
    fields terminated by ';' OPTIONALLY ENCLOSED BY '"'
    lines terminated by '\n'
    ignore 1 lines
    (@nome, @cargo, @numero, @cod_uf, @uf, @nome_uf, @nr_part, @sg_part, @partido,
     @valor, @data, @recurso, @tp_recurso, @especie, @tp_especie, @doador, @cpf_doador, @meaning)
SET
  ano="2004",
  tipo="candidato",
  uf=TRIM(@uf),
  candidato=TRIM(@nome),
  cargo=TRIM(@cargo),
  numero=TRIM(@numero),
  cpf_doador=TRIM(@cpf_doador),
  doador=TRIM(@doador),
  partido=TRIM(@partido),
  recurso=TRIM(@especie),
  data=LEFT(TRIM(@data), 10),
  valor=IF(TRIM(@valor) = '', NULL, REPLACE(TRIM(@valor), ',', '.'));
SHOW WARNINGS;

-- load comites
# DS_ORGAO";"NR_PART";"SG_PART";"SG_UE_SUP";"NO_UE";"SG_UE";"VR_RECEITA";"DT_RECEITA";"RTRIM(LTRIM(DR.CD_TITULO))";"CD_TITULO";"DECODE(REC.TP_RECURSO,0,'EMESP�CIE',1,'CHEQUE',2,'ESTIMADO','N�OINFORMADO')";"TP_RECURSO";"NO_DOADOR";"CD_CPF_CGC_DOA";"RV_MEANING
# Comit� Financeiro Municipal �nico";"15";"PMDB";"RS";"PORTO MAUA";"87467";"2000";"30/09/2004";"10010200";"10010200";"Estimado";"2";"JOSE CARLOS DA FONSECA PARADA";"33673721020";"Regular

load data local infile 'fontes_tse/2004/prestacao_contas_2004/2004/Comitê/Receita/ReceitaComitê.CSV'
  into table doacoes
    fields terminated by ';' OPTIONALLY ENCLOSED BY '"'
    lines terminated by '\n'
    ignore 1 lines
    (@tipodiretorio, @numero, @partido, @uf, @seqcom, @uf_b, @valor, @data, @tit_a, @tit_b,
    @recurso, @tp_recurso, @doador, @cpf, @meaning)

  SET
    ano="2004",
    tipo="comite",
    uf=TRIM(@uf),
    candidato=TRIM(@tipodiretorio),
    doador=TRIM(@doador),
    partido=TRIM(@partido),
    numero=TRIM(@numero),
    cpf_doador=TRIM(@cpf),
    recurso=TRIM(@recurso),
    motivo=TRIM(@descrec),
    data=LEFT(@data, 10),
    valor=IF(TRIM(@valor) = '', NULL, REPLACE(TRIM(@valor), ',', '.'));
SHOW WARNINGS;
